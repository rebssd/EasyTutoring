{% extends "tutor_area/turmaArea.html" %}
{% load widget_tweaks %}
{% block pageHeader %}
    <h2 class="page-header">Lançar Frequência</h2>
{% endblock pageHeader %}

{% block form %}
    <div class="panel-body" >
        <div class="table-responsive table-bordered">
            <table class="table">

                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Presença</th>
                    </tr>
                </thead>
                <tbody>
                	{% for aluno in alunos %}
                        <tr>
                            <td>{{aluno.nome_completo}}</td>
                             <td><select id="selecao" class="form-control" style="width: 110px;">
                                  <option value="{{aluno.id}}">Falta</option>
                                  <option value="{{aluno.id}}">Presente</option>
                                </select>   </td>

                        </tr>
					{% endfor %}
                </tbody>

            </table>
                <center><button class="btn btn-default btn-lg btn-login" id="submeter">Cadastrar</button></center><br>

        </div>
        <!-- /.table-responsive -->
    </div>
{% endblock form %}

{% block javascript %}
<script>
$(document).ready(function(){

    var frequencia = [];
    var alunos = [];
    $('#submeter').click(function() {
            $("tr td #selecao option:selected").each(function() {
                frequencia.push($(this).text());
                var valor = this.value;
                alunos.push(valor);

            }); 
            $.ajax({
            url: 'cadastrarFrequencia',
             method: 'POST',
             data: {frequencia: frequencia, alunos: alunos, csrfmiddlewaretoken: '{{ csrf_token }}'},
             success : function(html) {
                    window.history.pushState("", "", "/");
                    window.location.href = "tutor_area/turmaArea/{{turma.id}}/"
                }

          });

    });
});

</script>
{% endblock javascript %}
